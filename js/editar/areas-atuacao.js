"use strict";var _createClass=function(){function a(a,e){for(var t=0;t<e.length;t++){var o=e[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(a,o.key,o)}}return function(e,t,o){return t&&a(e.prototype,t),o&&a(e,o),e}}();function _classCallCheck(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}var AreaAtuacao=function(){function a(){_classCallCheck(this,a)}return _createClass(a,[{key:"AutocompleteItem",value:function(a,e,t,o,r,s,u,n,c,_){return{id:a,label:e,content:t,fonte:o,placeholder:r,type:s,custom_class:u,areas:n,subareas:c,subareas_selected:_}}},{key:"loadSuggestions",value:function(a,e,t,o,r,s){for(var u=a[0],n=a[1],c=0;c<n.length;c++)n[c].label=n[c].tx_nome_subarea_atuacao,n[c].value=n[c].cd_subarea_atuacao;var _=[],i=o.areasAtuacao().form_items;_.push(this.AutocompleteItem(i[0].id,i[0].label,t.validateObject(r,"Não informado"),t.validateObject(s,"Não informado"),i[0].placeholder,i[0].type,i[0].custom_class,u,n)),i.splice(0,1);for(var l=0;l<i.length;l++){if(0!==t.validateObject(e,0)){if("macro_area_1"===i[l].id&&(i[l].content=e?e[0].tx_nome_area_atuacao:"",i[l].subareas_selected=e?e[0].subarea_atuacao:"",i[l].fonte=e?e[0].ft_area_atuacao:null),"macro_area_2"===i[l].id&&(i[l].content=e.length>1?e[1].tx_nome_area_atuacao:"",i[l].subareas_selected=e.length>1?e[1].subarea_atuacao:null,i[l].fonte=e.length>1?e[1].ft_area_atuacao:null),t.validateObject(e[0],!1))if("Outros"===e[0].tx_nome_area_atuacao){if("macro_area_1_outros"===i[l].id&&(i[l].content=e[0].tx_nome_area_atuacao_outra?e[0].tx_nome_area_atuacao_outra:""),"sub_area_1_outros"===i[l].id){var d=e[0].subarea_atuacao?e[0].subarea_atuacao.length:0;for(c=0;c<d;c++)null!==e[0].subarea_atuacao[c].tx_nome_subarea_atuacao_outra&&(i[l].content=e[0].subarea_atuacao[c].tx_nome_subarea_atuacao_outra?e[0].subarea_atuacao[c].tx_nome_subarea_atuacao_outra:"",console.log(i[l].content))}}else if("macro_area_1_outros"===i[l].id&&(i[l].content=e[0].tx_nome_area_atuacao_outra?e[0].tx_nome_area_atuacao_outra:""),"sub_area_1_outros"===i[l].id)for(d=e[0].subarea_atuacao?e[0].subarea_atuacao.length:0,c=0;c<d;c++)null!==e[0].subarea_atuacao[c].tx_nome_subarea_atuacao_outra&&(i[l].content=e[0].subarea_atuacao[c].tx_nome_subarea_atuacao_outra?e[0].subarea_atuacao[c].tx_nome_subarea_atuacao_outra:"");if(t.validateObject(e[1],!1))if("Outros"===e[1].tx_nome_area_atuacao){if("macro_area_2_outros"===i[l].id&&(i[l].content=e[1].tx_nome_area_atuacao_outra?e[1].tx_nome_area_atuacao_outra:""),"sub_area_2_outros"===i[l].id)for(d=e[1].subarea_atuacao?e[1].subarea_atuacao.length:0,c=0;c<d;c++)null!==e[1].subarea_atuacao[c].tx_nome_subarea_atuacao_outra&&(i[l].content=e[1].subarea_atuacao[c].tx_nome_subarea_atuacao_outra?e[1].subarea_atuacao[c].tx_nome_subarea_atuacao_outra:"")}else if("macro_area_2_outros"===i[l].id&&(i[l].content=e[1].subarea_atuacao?e[1].tx_nome_area_atuacao_outra:""),"sub_area_2_outros"===i[l].id)for(d=e[1].subarea_atuacao?e[1].subarea_atuacao.length:0,c=0;c<d;c++)null!==e[1].subarea_atuacao[c].tx_nome_subarea_atuacao_outra&&(i[l].content=e[1].subarea_atuacao[c].tx_nome_subarea_atuacao_outra?e[1].subarea_atuacao[c].tx_nome_subarea_atuacao_outra:"")}"autocomplete"===i[l].custom_class?_.push(this.AutocompleteItem(i[l].id,i[l].label,i[l].content,i[l].fonte,i[l].placeholder,i[l].type,i[l].custom_class,u,n,i[l].subareas_selected)):_.push(t.FormItens(i[l].id,i[l].label,i[l].content,i[l].fonte,i[l].placeholder,i[l].type,i[l].options,i[l].pretext,i[l].custom_class,i[l].hide))}return{formItens:_,area_suggestions:a,macro_area_suggestions:u=$.map(u,function(a){return{label:a.tx_nome_area_atuacao,value:a.tx_nome_area_atuacao,id:a.cd_area_atuacao}})}}},{key:"carregaMacro",value:function(a,e){var t="js/controller.php";return $.ajax({url:t,async:!1,type:"GET",dataType:"json",data:{flag:"consulta",rota:a.AreaAtuacao()},success:function(o){e.push(o),$.ajax({url:t,async:!1,type:"GET",dataType:"json",data:{flag:"consulta",rota:a.SubAreaAtuacao()},success:function(a){e.push(a)},error:function(a){console.log(a)}})},error:function(a){console.log(a)}}),e}},{key:"montarAreasDeAtuacao",value:function(a,e,t,o,r,s,u,n,c){var _=e.validateObject(a.area_atuacao,[]),i=e.validateObject(_.area_atuacao_outra,[]);_=[].concat(_).concat(i);var l=this.carregaMacro(o,[],e),d=e.validateObject(_[0],[]),h=this.loadSuggestions(l,d.area_atuacao,e,t,r,s),f=h.formItens;return c=u.createFactory(c),n.render(c({header:{priority:"2",text:"Áreas e Subáreas de Atuação da OSC"},dados:f}),document.getElementById("areas_de_atuacao")),this.carregarAreasAtuacao(h.area_suggestions,h.macro_area_suggestions),l}},{key:"carregarAreasAtuacao",value:function(a,e){var t=0;$("#areas_de_atuacao .autocomplete").autocomplete({minLength:0,create:function(a,t){for(var o=$(this).attr("placeholder"),r=0;r<e.length;r++){if(e[r].value===o){var s=$(this).siblings(".checkboxList").find("#subareas-"+r);s.hasClass("hidden")&&s.toggleClass("hidden");for(var u=0;u<e.length;u++)if(o===e[u].tx_nome_area_atuacao){var n=!1;s.find("label").each(function(){e[u].tx_nome_subarea_atuacao===$(this).text().trim()&&(n=$(this))}),n?n.find("input").prop("checked",!0):s.find("#outros").val(e[u].tx_nome_subarea_atuacao)}}}},source:e,change:function(a,e){},select:function(a,o){"macro_area_1"==a.target.id?($("#sub_area_1_outros").parent().parent().addClass("hidden"),$("#sub_area_1_outros").val(""),$(this).parent().find(":checkbox").prop("checked",!1)):($("#sub_area_2_outros").parent().parent().addClass("hidden"),$("#sub_area_2_outros").val(""),$(this).parent().find(":checkbox").prop("checked",!1));var r=a.target,s=e.indexOf(o.item)+1;t=s;var u=$($(r).siblings(".checkboxList")[0]);u.children().each(function(a){$(this).hasClass("hidden")||($(this).toggleClass("hidden"),$(this).children().each(function(a){var e=$($(this).find("input")[0]);e.is(":checked")&&e.prop("checked",!1),"text"==e.prop("type")&&e.val("")}))});var n=u.find("#subareas-"+s);n.hasClass("hidden")&&n.toggleClass("hidden");var c=o.item.value,_=$(this).closest(".form-group"),i=null;(i="macro_area_1"===(s=_.find(".autocomplete").attr("id"))?_.siblings().find("#macro_area_1_outros").closest(".form-group"):_.siblings().find("#macro_area_2_outros").closest(".form-group"),"Outros"===c)?(i.toggleClass("hidden"),i.hasClass("hidden")&&i.find("input").val("")):i.hasClass("hidden")||(i.toggleClass("hidden"),i.find("input").val(""))}}),$(".autocomplete").on("click",function(){$(this).autocomplete("search","")}),$(".autocomplete").keyup(function(){if(""===$(this).val()&&0!=t){var a=t,e=$(this).parent().find("#subareas-"+a);e.hasClass("hidden")||e.toggleClass("hidden")}}),$(".autocomplete").focusout(function(a){var e=this.value.toLowerCase(),t=!1,o=this.id,r=o.split("macro_area_");$("#ui-id-"+r[1]+" .ui-menu-item-wrapper").each(function(){if($(this).text().toLowerCase()===e)return t=!0,!1}),t||($("#"+o).val(""),$("#"+o).parent().find(".checkboxList div[id^='subareas-']:not(:hidden)").each(function(){$(this).toggleClass("hidden")}))}),$(".checkboxList :checkbox").change(function(){if("Outros"===$(this).closest("label").text()){var a=$(this).closest(".form-group"),e=null;if((e="macro_area_1"===a.find(".autocomplete").attr("id")?a.siblings().find("#sub_area_1_outros").closest(".form-group"):a.siblings().find("#sub_area_2_outros").closest(".form-group")).toggleClass("hidden"),e.hasClass("hidden"))e.find("input").val("")}}),$(".checkboxList").each(function(){$(this).find("input").each(function(){if($(this).is(":checked")&&"Outros"===$(this).closest("label").text()){var a=$(this).closest(".form-group"),e=null;if((e="macro_area_1"===a.find(".autocomplete").attr("id")?a.siblings().find("#sub_area_1_outros").closest(".form-group"):a.siblings().find("#sub_area_2_outros").closest(".form-group")).toggleClass("hidden"),e.hasClass("hidden"))e.find("input").val("")}})});var o=$("#macro_area_1"),r=$("#macro_area_2");"Outros"==o.val()&&$("#macro_area_1_outros").parent().parent().removeClass("hidden"),"Outros"==r.val()&&$("#macro_area_2_outros").parent().parent().removeClass("hidden")}}]),a}();